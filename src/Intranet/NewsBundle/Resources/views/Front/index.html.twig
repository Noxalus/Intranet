{% extends 'IntranetCoreBundle:Core:layout.html.twig' %}

{% block content %}

<div class="row">
<div class="span7">
    <h1>News</h1>
    
    {% if is_granted('ROLE_TEACHER') %}
    <p>
        <a href="{{ path('add_news') }}">Ajouter une news</a><br/>
        <a href="{{ path('list_picto')}}">Gérer les pictogrammes</a>
    </p>
    {% endif %}
    
    {% for article in news %}
    <div class="well">
        <h3>
            {% if article.picto != null %}
            <img src="./../{{ article.picto.getWebPath() }}" alt="{{article.picto.description}}" height="30" width="30"/> {%endif %}{{ article.title }}
            {% if is_granted('ROLE_TEACHER') %}
                <a href="{{ path('edit_news', { 'id_article' : article.id }) }}" class="btn btn-warning btn-mini"><i class="icon-white icon-pencil"></i></a>
                <a href="{{ path('delete_news', { 'id_article' : article.id }) }}" class="btn btn-danger btn-mini"><i class="icon-white icon-remove"></i></a>
            {% endif %}
            <br />
        </h3>
            
        <small class="news-subtitle subtitle">{{ article.date|date('Y/m/d à H:i:s') }} - par {{ article.author.firstname }} {{ article.author.lastname }}</small>

        <div class="news-content">{{ article.content|raw }}</div>
    </div>
        <br />
    {% endfor %}
    <br/>
    {% if num_page != 0 %}
        <a href="{{ path('home', { 'num_page' : num_page - 1 }) }}"><--- Page précédente </a>
        {% if ismore %}
        -
        {% endif %}
    {% endif %}
    {% if ismore %}
        <a href="{{ path('home', { 'num_page' : num_page + 1 }) }}"> Page suivante ---></a>
    {% endif %}
</div>

<div class="span4" id="right-column">
{% if is_granted("IS_AUTHENTICATED_REMEMBERED") %}
    <div class="center">
    Bonjour <b>{{ app.user.firstName }} {{ app.user.lastName }}</b>
    <br />
    (<a href="{{ path('fos_user_security_logout') }}">Déconnexion</a>)
    <br /><br />
    {{ user_photo(app.user, 'user_photo') }}
</div>
    
{% render(controller('IntranetScheduleBundle:Render:nextCourses', {'max': 5})) %}
{# render(controller('IntranetProjectBundle:Render:nextDeadlines', {'max': 5})) #}
{% endif %}
</div>
</div>

{% endblock %}